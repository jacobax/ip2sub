# ğŸŒ Cloudflare Worker - VLESS/Trojan è®¢é˜…å™¨  

æœ¬é¡¹ç›®åŸºäº Cloudflare Workers æ„å»ºï¼Œæ”¯æŒè‡ªåŠ¨èšåˆå¤šä¸ªæ¥æºçš„èŠ‚ç‚¹æ•°æ®ï¼Œå¹¶æ ¹æ®å‚æ•°åŠ¨æ€ç”Ÿæˆ **VLESS** æˆ– **Trojan** çš„è®¢é˜…å†…å®¹ï¼Œå…¼å®¹ **Clash / Sing-box** ç­‰å®¢æˆ·ç«¯ã€‚  

---

## âš™ï¸ åŠŸèƒ½ç‰¹æ€§  

- âœ… åŠ¨æ€ç”Ÿæˆ VLESS / Trojan èŠ‚ç‚¹é“¾æ¥  
- âœ… æ”¯æŒå¤šæ¥æºåˆå¹¶ï¼ˆAPIã€å›ºå®šåˆ—è¡¨ã€å·®å¼‚åˆ—è¡¨ï¼‰  
- âœ… å¯æŒ‡å®šæ¯ä¸ªæ¥æºéšæœºæŠ½å–æ•°é‡  
- âœ… æ”¯æŒ `uuid`ã€`mima`ã€`host`ã€`path`ã€`prefix` ç­‰åŠ¨æ€æ›¿æ¢  
- âœ… æ”¯æŒ `KV` ç¼“å­˜ FDIPï¼ˆå¤‡ç”¨èŠ‚ç‚¹ä¿¡æ¯ï¼‰  
- âœ… æ”¯æŒè®¢é˜…è½¬æ¢ï¼ˆClash / Sing-boxï¼‰  
- âœ… å¯é€‰å‚æ•°æ§åˆ¶è¾“å‡ºæ ¼å¼

- âœ… **å¼‚æ­¥å¤„ç†åä»£ï¼ˆæœªéªŒè¯ï¼‰.js**æ ¹æ®åä»£åŸŸåå…³é”®è¯å¼‚æ­¥å¤„ç†ï¼Œæ·»åŠ å¯¹åº”å…³é”®è¯å¯ä»¥æ”¯æŒ`å¨å»‰`ã€`å¤©è¯š`çš„åä»£åŸŸå  

---

## ğŸ§© ç¯å¢ƒå˜é‡è¯´æ˜  

| å˜é‡å | è¯´æ˜ |
| :-- | :-- |
| `UUID` | VLESS ç”¨æˆ· UUID |
| `MIMA` | Trojan ç”¨æˆ·å¯†ç  |
| `hostV` | VLESS èŠ‚ç‚¹çš„ SNI / Host |
| `hostT` | Trojan èŠ‚ç‚¹çš„ SNI / Host |
| `VLESS_PATH_PREFIX` | VLESS èŠ‚ç‚¹è·¯å¾„å‰ç¼€ |
| `TROJAN_PATH_PREFIX` | Trojan èŠ‚ç‚¹è·¯å¾„å‰ç¼€ |
| `apiUni` | UNI èŠ‚ç‚¹æ¥æº API åœ°å€ |
| `apiDiff` | DIFF èŠ‚ç‚¹æ¥æº API åœ°å€ |
| `IPS` | å›ºå®šèŠ‚ç‚¹åˆ—è¡¨ï¼ˆIP:PORT æ ¼å¼ï¼‰ |
| `FDIP` | FDIP å¤‡ç”¨èŠ‚ç‚¹åˆ—è¡¨ |
| `KV_FDIP_KEY` | å­˜æ”¾äº KV çš„ FDIP é”®å |
| `UUID_CACHE` | KV å‘½åç©ºé—´ï¼Œç”¨äºç¼“å­˜æ•°æ® |

> **æ³¨æ„ï¼š**  
> ä»¥ä¸Šç¯å¢ƒå˜é‡åœ¨ `Cloudflare Dashboard â†’ Workers â†’ Settings â†’ Variables` ä¸­é…ç½®ã€‚  

---

## ğŸ”¢ æŸ¥è¯¢å‚æ•°è¯´æ˜  

ä»¥ä¸‹å‚æ•°å¯ç›´æ¥åœ¨è®¢é˜…é“¾æ¥åè¿½åŠ ï¼Œä¾‹å¦‚ï¼š
```
https://example.workers.dev/?target=clash&uni_count=5&diff_count=3
```
| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
| :-- | :-- | :-- |
| `target` | `singbox` | è®¢é˜…è¾“å‡ºæ ¼å¼ï¼Œå¯é€‰ `clash` / `singbox` |
| `uuid` | ç¯å¢ƒå˜é‡ `UUID` | åŠ¨æ€è¦†ç›– UUID |
| `mima` | ç¯å¢ƒå˜é‡ `MIMA` | åŠ¨æ€è¦†ç›– Trojan å¯†ç  |
| `hostV` / `hostT` | ç¯å¢ƒå˜é‡å€¼ | åŠ¨æ€è¦†ç›–èŠ‚ç‚¹ä¸»æœºå |
| `uni_count` | `5` | ä» UNI æ¥æºæ¯ä¸ª name éšæœºæŠ½å–æ¡ç›®æ•°<br>`0` è¡¨ç¤ºç¦ç”¨ï¼Œ`all` è¡¨ç¤ºå…¨å– |
| `diff_count` | `5` | åŒä¸Šï¼Œç”¨äº DIFF æ¥æº |
| `fdip` | ç©º | å¤‡ç”¨èŠ‚ç‚¹æŒ‡å®šæ–¹å¼ï¼š<br>â€¢ `ip:port` å›ºå®šå•èŠ‚ç‚¹<br>â€¢ `all` è½®è¯¢æ‰€æœ‰ FDIP èŠ‚ç‚¹ |
| `vlessPrefix` / `trojanPrefix` | ç¯å¢ƒå˜é‡å€¼ | è¦†ç›–è·¯å¾„å‰ç¼€ |
| `trojan=1` | - | å¯ç”¨ Trojan æ¨¡å¼ï¼ˆé»˜è®¤ VLESSï¼‰ |

---

## ğŸ§  å·¥ä½œé€»è¾‘  

1. ä»é…ç½®çš„å¤šä¸ªæ¥æºï¼ˆAPIã€å›ºå®šåˆ—è¡¨ã€KVï¼‰è·å–èŠ‚ç‚¹æ•°æ®ã€‚  
2. æŒ‰ `uni_count` / `diff_count` æŠ½å–æŒ‡å®šæ•°é‡çš„æ¡ç›®ã€‚  
3. ç”Ÿæˆå¯¹åº”åè®®ï¼ˆVLESS æˆ– Trojanï¼‰çš„å®Œæ•´èŠ‚ç‚¹é“¾æ¥ã€‚  
4. è‹¥æŒ‡å®š `target=clash` æˆ– `target=singbox`ï¼Œåˆ™è‡ªåŠ¨è½¬ä¸ºå¯¹åº”è®¢é˜…æ ¼å¼ã€‚  
5. è¾“å‡ºèšåˆç»“æœä½œä¸ºçº¯æ–‡æœ¬æˆ–è®¢é˜…é…ç½®æ–‡ä»¶ã€‚  

---

## ğŸ“¦ éƒ¨ç½²æ­¥éª¤  

1. ç™»å½• [Cloudflare Dashboard](https://dash.cloudflare.com/)ã€‚  
2. åˆ›å»ºæ–° `Pages` å¹¶å‹ç¼©æˆ–æ–‡ä»¶å¤¹ä¸Šä¼  `_worker.js`ã€‚  
3. åœ¨ **Settings â†’ Variables â†’ Environment Variables** ä¸­é…ç½®æ‰€éœ€å˜é‡ã€‚  
4. è‹¥ä½¿ç”¨ KV åä»£IPæºï¼š  
   - åœ¨ **Workers KV** åˆ›å»ºå‘½åç©ºé—´ï¼Œåç§°éšæ„ã€‚  
   - ç»‘å®šå˜é‡åä¸º`KV`è‡³ Worker ç¯å¢ƒã€‚  
5. ç‚¹å‡» **Deploy** å‘å¸ƒã€‚  

---

## ğŸ” ç¤ºä¾‹é“¾æ¥  

**æ™®é€šè®¢é˜…ï¼ˆVLESSï¼‰**
```
https://your-worker.workers.dev/?target=singbox
```
**Clash è®¢é˜…**
```
https://your-worker.workers.dev/?target=clash
```
**ä»…å– 3 æ¡ UNI æ¥æºèŠ‚ç‚¹å¹¶ç¦ç”¨ DIFF æ¥æº**
```
https://your-worker.workers.dev/?uni_count=3&diff_count=0
```
**ä½¿ç”¨å›ºå®š FDIP**
```
https://your-worker.workers.dev/?fdip=1.2.3.4:443
```
**å¯ç”¨ Trojan æ¨¡å¼**
```
https://your-worker.workers.dev/?trojan=1
```
---

## ğŸ§¾ è°ƒè¯•å»ºè®®  

- è‹¥è®¿é—®è¿”å› `404`ï¼šæ£€æŸ¥ API æˆ–å›ºå®šèŠ‚ç‚¹æ˜¯å¦æœ‰å†…å®¹ã€‚  
- è‹¥è¿”å› `500`ï¼šæ£€æŸ¥ FDIP æ ¼å¼æ˜¯å¦æ­£ç¡®ã€‚  
- å¯é€šè¿‡æ—¥å¿—æŸ¥çœ‹ `console.log` è¾“å‡ºä»¥ç¡®è®¤èŠ‚ç‚¹æ¥æºæ˜¯å¦åŠ è½½æˆåŠŸã€‚  

---

## ğŸ“˜ é…ç½®ç¤ºä¾‹  

ä»¥ä¸‹ä¸ºç¯å¢ƒå˜é‡å†…å®¹ç¤ºä¾‹ï¼ˆæ‰€æœ‰ç¤ºä¾‹å‡ä¸ºä¼ªé€ æ•°æ®ï¼‰ï¼š  

**IPS**
```
1.1.1.1:443#HK_AWS
2.2.2.2:443#JP_Tokyo
3.3.3.3:2053#US_LA
```
**FDIP**
```
104.16.10.5:8443#cfnode1
104.19.21.7:2053#cfnode2
104.20.33.8:2087#cfnode3
```
**apiUni**
```
https://api.example.com/uni?name=hk
https://api.example.com/uni?name=jp
https://api.example.com/uni?name=us
```
**apiDiff**
```
https://api.example.com/diff?region=hk
https://api.example.com/diff?region=jp
https://api.example.com/diff?region=us
```
---

## ğŸ“š æ–‡ä»¶ç»“æ„

. â”œâ”€â”€ _worker.js      # Cloudflare Worker ä¸»ç¨‹åº  
â”œâ”€â”€ README.md       # ä½¿ç”¨æ–‡æ¡£  
â””â”€â”€ /KV/            # KV å­˜å‚¨å‘½åç©ºé—´ï¼ˆä»…è¯´æ˜ï¼Œä¸æ˜¯å®é™…æ–‡ä»¶å¤¹ï¼‰  

---

## ğŸ“„ License  

MIT License  
ä½œè€…ä¿ç•™ä»£ç ç»“æ„ä¸é€»è¾‘çš„ç‰ˆæƒè¯´æ˜æƒã€‚  

---

**æœ€åæ›´æ–°ï¼š** 2025-12-1


---
